<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Fiscaliza√ß√£o de Poda de √Årvore</title>
    
    <!-- Inclus√£o do framework de CSS Tailwind para estiliza√ß√£o r√°pida e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 
      PALETA DE CORES ESCOLHIDA: Harmonia Calma (Cinza claro, Cinza escuro, Verde prim√°rio, Azul de destaque)
      Este esquema de cores foi escolhido para criar uma interface limpa, profissional e agrad√°vel.
    -->
    
    <!-- 
      PLANO DA ESTRUTURA DO APLICATIVO (VERS√ÉO 2):
      A aplica√ß√£o √© uma SPA (Single-Page Application). As telas agora incluem: Login, Cadastro, Recuperar Senha, Painel Principal, Meus Dados (NOVO), 
      Formul√°rio de Nova Solicita√ß√£o, Lista de Solicita√ß√µes e Detalhe da Solicita√ß√£o (com Linha do Tempo - NOVO).
      A estrutura foi aprimorada para incluir gerenciamento de perfil de usu√°rio e um acompanhamento de processos mais detalhado, tornando a experi√™ncia mais completa.
    -->
    
    <!-- 
      ESCOLHAS DE VISUALIZA√á√ÉO E CONTE√öDO:
      - Gerenciamento de Perfil: Uma nova tela permite que o usu√°rio visualize e edite seus dados cadastrais.
      - Linha do Tempo: A tela de detalhes foi transformada em uma linha do tempo vertical, usando HTML e CSS para mostrar o hist√≥rico de cada solicita√ß√£o de forma clara e cronol√≥gica.
      - Login Gov.br: A funcionalidade do bot√£o foi aprimorada para simular uma autentica√ß√£o real, melhorando o realismo do prot√≥tipo.
      - Filtros e Notifica√ß√µes: Mantidos e aprimorados para uma melhor usabilidade.
    -->
    
    <!-- CONFIRMA√á√ÉO: Nenhum gr√°fico SVG ou a biblioteca Mermaid.js foram utilizados. -->

    <style>
        /* Estilos personalizados para controlar a exibi√ß√£o das "telas" do aplicativo */
        .tela { display: none; }
        .tela-ativa { display: flex; }

        /* Estilo base para as etiquetas (badges) de status das solicita√ß√µes */
        .etiqueta-status {
            padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem;
            font-weight: 600; text-transform: uppercase;
        }

        /* Cores espec√≠ficas para cada status */
        .status-em-analise, .status-em-an√°lise { background-color: #f59e0b; color: white; }
        .status-aprovado { background-color: #10b981; color: white; }
        .status-recusado { background-color: #ef4444; color: white; }
        .status-criado { background-color: #3b82f6; color: white; }

        /* Estilos para o sistema de notifica√ß√£o (toast) */
        .notificacao-toast {
            position: fixed; bottom: -100px; left: 50%;
            transform: translateX(-50%); padding: 1rem 1.5rem;
            border-radius: 0.5rem; color: white; font-weight: 500;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: bottom 0.5s ease-in-out; z-index: 100;
        }
        .notificacao-toast.sucesso { background-color: #22c55e; }
        .notificacao-toast.erro { background-color: #ef4444; }
        .notificacao-toast.info { background-color: #3b82f6; }
        .notificacao-toast.mostrar { bottom: 20px; }

        /* NOVO: Estilos para a Linha do Tempo */
        .timeline { position: relative; padding-left: 2.5rem; }
        .timeline::before {
            content: ''; position: absolute; left: 0.5rem; top: 0;
            bottom: 0; width: 2px; background-color: #e2e8f0;
        }
        .timeline-item { position: relative; margin-bottom: 1.5rem; }
        .timeline-item:last-child { margin-bottom: 0; }
        .timeline-dot {
            position: absolute; left: -2.0rem; top: 0.25rem;
            height: 1rem; width: 1rem; border-radius: 9999px;
            border: 2px solid white;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-emerald-50 to-slate-100 font-sans text-slate-800">

    <!-- Container principal que envolve toda a aplica√ß√£o -->
    <div id="aplicativo-container" class="min-h-screen flex flex-col items-center p-4 py-8 sm:justify-center">

        <!-- ====================================================================== -->
        <!-- TELA DE LOGIN                                                          -->
        <!-- ====================================================================== -->
        <section id="tela-login" class="tela w-full max-w-sm mx-auto flex-col items-center justify-center">
            <header class="text-center mb-8">
                <img src="https://www.riopreto.sp.gov.br/wp-content/uploads/2022/01/brasao-colorido-e-texto-prefeitura-SJRP-2021.png" alt="Logo Prefeitura de S√£o Jos√© do Rio Preto" class="h-28 mx-auto mb-4">
                <h1 class="text-3xl font-bold text-slate-700">Bem-vindo!</h1>
                <p class="text-slate-500">Acesse sua conta para continuar</p>
            </header>
            <main class="w-full bg-white p-8 rounded-xl shadow-lg">
                <div class="space-y-4">
                    <div>
                        <label for="cpf-login" class="block text-sm font-medium text-slate-600">CPF / CNPJ</label>
                        <input type="text" id="cpf-login" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm" placeholder="000.000.000-00">
                    </div>
                    <div>
                        <div class="flex justify-between">
                            <label for="senha-login" class="block text-sm font-medium text-slate-600">Senha</label>
                            <a href="#" onclick="event.preventDefault(); mostrarTela('tela-recuperar-senha')" class="text-sm font-medium text-emerald-600 hover:underline">Esqueci a senha</a>
                        </div>
                        <div class="relative mt-1">
                            <input type="password" id="senha-login" class="block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm pr-10" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                            <button type="button" onclick="alternarVisibilidadeSenha('senha-login', 'icone-senha-login')" class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-500">
                                <span id="icone-senha-login">üëÅÔ∏è</span>
                            </button>
                        </div>
                    </div>
                    <button onclick="efetuarLogin()" class="w-full bg-emerald-600 text-white py-2.5 px-4 rounded-md hover:bg-emerald-700 font-semibold">Acessar</button>
                    <div class="relative flex py-3 items-center">
                        <div class="flex-grow border-t border-slate-200"></div><span class="flex-shrink mx-4 text-slate-400 text-sm">OU</span><div class="flex-grow border-t border-slate-200"></div>
                    </div>
                    <!-- Bot√£o Gov.br agora chama uma fun√ß√£o espec√≠fica -->
                    <button onclick="loginGovBr()" class="w-full bg-blue-600 text-white py-2.5 px-4 rounded-md hover:bg-blue-700 font-bold flex items-center justify-center gap-2">
                        <img src="https://logodownload.org/wp-content/uploads/2021/01/gov-br-logo-1.png" class="h-6" alt="Logo Gov.br"/> Entrar com gov.br
                    </button>
                </div>
            </main>
            <footer class="text-center mt-6">
                <p class="text-sm text-slate-600">N√£o tem uma conta? <a href="#" onclick="event.preventDefault(); mostrarTela('tela-cadastro')" class="font-medium text-emerald-600 hover:underline">Cadastre-se aqui.</a></p>
            </footer>
        </section>

        <!-- ====================================================================== -->
        <!-- TELA DE CADASTRO                                                       -->
        <!-- ====================================================================== -->
        <section id="tela-cadastro" class="tela w-full max-w-lg mx-auto flex-col items-center justify-center">
            <header class="text-center mb-8">
                <img src="https://www.riopreto.sp.gov.br/wp-content/uploads/2022/01/brasao-colorido-e-texto-prefeitura-SJRP-2021.png" alt="Logo Prefeitura" class="h-24 mx-auto mb-4">
                <h1 class="text-3xl font-bold text-slate-700">Criar Conta</h1>
                <p class="text-slate-500">Preencha os dados para se cadastrar</p>
            </header>
            <main class="w-full bg-white p-8 rounded-xl shadow-lg">
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2">Dados Pessoais</h3>
                    <div>
                        <label for="cadastro-nome" class="block text-sm font-medium text-slate-600">Nome Completo</label>
                        <input type="text" id="cadastro-nome" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm" placeholder="Seu nome completo" required>
                    </div>
                    <div>
                        <label for="cadastro-cpf" class="block text-sm font-medium text-slate-600">CPF / CNPJ</label>
                        <input type="text" id="cadastro-cpf" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm" placeholder="000.000.000-00" required>
                    </div>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2 pt-4">Endere√ßo</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                        <div class="md:col-span-1">
                            <label for="cadastro-cep" class="block text-sm font-medium text-slate-600">CEP</label>
                            <input type="text" id="cadastro-cep" placeholder="15000-000" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm" required>
                        </div>
                        <div class="md:col-span-2">
                            <button onclick="buscarCep()" class="w-full bg-slate-200 text-slate-700 py-2 px-4 rounded-md hover:bg-slate-300 font-semibold text-sm">Buscar Endere√ßo</button>
                        </div>
                        <div class="md:col-span-3">
                            <label for="cadastro-logradouro" class="block text-sm font-medium text-slate-600">Logradouro</label>
                            <input type="text" id="cadastro-logradouro" placeholder="Preenchido automaticamente" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm" required readonly>
                        </div>
                        <div>
                            <label for="cadastro-numero" class="block text-sm font-medium text-slate-600">N√∫mero</label>
                            <input type="text" id="cadastro-numero" placeholder="123" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="cadastro-bairro" class="block text-sm font-medium text-slate-600">Bairro</label>
                            <input type="text" id="cadastro-bairro" placeholder="Preenchido automaticamente" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm" required readonly>
                        </div>
                    </div>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2 pt-4">Seguran√ßa</h3>
                    <div>
                        <label for="cadastro-senha" class="block text-sm font-medium text-slate-600">Senha</label>
                        <div class="relative mt-1">
                            <input type="password" id="cadastro-senha" class="block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm pr-10" placeholder="Crie uma senha forte" required>
                             <button type="button" onclick="alternarVisibilidadeSenha('cadastro-senha', 'icone-senha-cadastro')" class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-500"><span id="icone-senha-cadastro">üëÅÔ∏è</span></button>
                        </div>
                    </div>
                    <div>
                        <label for="cadastro-senha-confirmacao" class="block text-sm font-medium text-slate-600">Confirmar Senha</label>
                        <div class="relative mt-1">
                           <input type="password" id="cadastro-senha-confirmacao" class="block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm pr-10" placeholder="Repita a senha" required>
                            <button type="button" onclick="alternarVisibilidadeSenha('cadastro-senha-confirmacao', 'icone-senha-confirmacao')" class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-500"><span id="icone-senha-confirmacao">üëÅÔ∏è</span></button>
                        </div>
                    </div>
                    <button onclick="cadastrarUsuario()" class="w-full bg-emerald-600 text-white py-2.5 px-4 rounded-md hover:bg-emerald-700 font-semibold mt-6">Criar Conta</button>
                </div>
            </main>
            <footer class="text-center mt-6">
                <p class="text-sm text-slate-600">J√° tem uma conta? <a href="#" onclick="event.preventDefault(); mostrarTela('tela-login')" class="font-medium text-emerald-600 hover:underline">Acesse aqui.</a></p>
            </footer>
        </section>

        <!-- ====================================================================== -->
        <!-- TELA DE RECUPERAR SENHA                                                -->
        <!-- ====================================================================== -->
        <section id="tela-recuperar-senha" class="tela w-full max-w-sm mx-auto flex-col items-center justify-center">
            <header class="text-center mb-8">
                <h1 class="text-3xl font-bold text-slate-700">Recuperar Senha</h1>
                <p class="text-slate-500 mt-2">Digite seu CPF/CNPJ para receber as instru√ß√µes.</p>
            </header>
            <main class="w-full bg-white p-8 rounded-xl shadow-lg space-y-4">
                <div>
                    <label for="cpf-recuperacao" class="block text-sm font-medium text-slate-600">CPF / CNPJ</label>
                    <input type="text" id="cpf-recuperacao" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm" placeholder="000.000.000-00">
                </div>
                <button onclick="recuperarSenha()" class="w-full bg-emerald-600 text-white py-2.5 px-4 rounded-md hover:bg-emerald-700 font-semibold">Enviar</button>
            </main>
            <footer class="text-center mt-6">
                <p class="text-sm text-slate-600">Lembrou a senha? <a href="#" onclick="event.preventDefault(); mostrarTela('tela-login')" class="font-medium text-emerald-600 hover:underline">Voltar para o login.</a></p>
            </footer>
        </section>

        <!-- ====================================================================== -->
        <!-- TELA PRINCIPAL (PAINEL / DASHBOARD)                                    -->
        <!-- ====================================================================== -->
        <section id="tela-principal" class="tela w-full max-w-4xl mx-auto flex-col">
            <header class="w-full flex justify-between items-center p-4 bg-white shadow-md rounded-lg mb-6">
                <div>
                    <h1 id="saudacao-usuario" class="text-xl font-bold text-slate-700">Ol√°!</h1>
                    <p class="text-sm text-slate-500">O que voc√™ precisa fazer hoje?</p>
                </div>
                <button onclick="efetuarLogout()" class="text-sm text-slate-500 hover:text-emerald-600 font-semibold">Sair</button>
            </header>
            <main class="w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div onclick="mostrarTela('tela-formulario')" class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg cursor-pointer transition-shadow text-center">
                    <div class="text-4xl text-emerald-500 mb-3">üå≥</div>
                    <h2 class="text-lg font-bold text-slate-700">Nova Solicita√ß√£o</h2>
                    <p class="text-sm text-slate-500">Pe√ßa uma poda, supress√£o ou fiscaliza√ß√£o de um servi√ßo.</p>
                </div>
                <div onclick="mostrarTela('tela-lista-solicitacoes')" class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg cursor-pointer transition-shadow text-center">
                    <div class="text-4xl text-emerald-500 mb-3">üìã</div>
                    <h2 class="text-lg font-bold text-slate-700">Minhas Solicita√ß√µes</h2>
                    <p class="text-sm text-slate-500">Acompanhe o andamento dos seus pedidos.</p>
                </div>
                <!-- NOVO: Card para a tela "Meus Dados" -->
                <div onclick="mostrarTela('tela-meus-dados')" class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg cursor-pointer transition-shadow text-center md:col-span-2 lg:col-span-1">
                    <div class="text-4xl text-emerald-500 mb-3">üë§</div>
                    <h2 class="text-lg font-bold text-slate-700">Meus Dados</h2>
                    <p class="text-sm text-slate-500">Visualize e edite suas informa√ß√µes pessoais e de endere√ßo.</p>
                </div>
            </main>
        </section>
        
        <!-- ====================================================================== -->
        <!-- NOVO: TELA DE MEUS DADOS (PERFIL DO USU√ÅRIO)                           -->
        <!-- ====================================================================== -->
        <section id="tela-meus-dados" class="tela w-full max-w-2xl mx-auto flex-col">
             <header class="w-full flex items-center mb-6 justify-between">
                <div class="flex items-center">
                    <button onclick="mostrarTela('tela-principal')" class="text-slate-500 hover:text-emerald-600 mr-4">‚Üê Voltar</button>
                    <h1 class="text-2xl font-bold text-slate-700">Meus Dados</h1>
                </div>
                <button id="botao-editar-dados" onclick="habilitarEdicaoDados()" class="bg-slate-200 text-slate-700 py-2 px-4 rounded-md hover:bg-slate-300 font-semibold text-sm">Editar</button>
                <button id="botao-salvar-dados" onclick="salvarDadosPessoais()" class="bg-emerald-600 text-white py-2 px-4 rounded-md hover:bg-emerald-700 font-semibold text-sm hidden">Salvar</button>
             </header>
             <main class="w-full bg-white p-8 rounded-xl shadow-lg space-y-4">
                <fieldset id="fieldset-dados-pessoais" disabled>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2">Dados Pessoais</h3>
                    <div>
                        <label for="perfil-nome" class="block text-sm font-medium text-slate-600">Nome Completo</label>
                        <input type="text" id="perfil-nome" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm">
                    </div>
                    <div>
                        <label for="perfil-cpf" class="block text-sm font-medium text-slate-600">CPF / CNPJ</label>
                        <input type="text" id="perfil-cpf" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm">
                    </div>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2 pt-4">Endere√ßo</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="md:col-span-1">
                            <label for="perfil-cep" class="block text-sm font-medium text-slate-600">CEP</label>
                            <input type="text" id="perfil-cep" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm">
                        </div>
                        <div class="md:col-span-2">
                            <label for="perfil-logradouro" class="block text-sm font-medium text-slate-600">Logradouro</label>
                            <input type="text" id="perfil-logradouro" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm">
                        </div>
                        <div>
                            <label for="perfil-numero" class="block text-sm font-medium text-slate-600">N√∫mero</label>
                            <input type="text" id="perfil-numero" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm">
                        </div>
                        <div class="md:col-span-2">
                            <label for="perfil-bairro" class="block text-sm font-medium text-slate-600">Bairro</label>
                            <input type="text" id="perfil-bairro" class="mt-1 block w-full px-3 py-2 bg-slate-100 border border-slate-300 rounded-md text-sm">
                        </div>
                    </div>
                </fieldset>
             </main>
        </section>

        <!-- ====================================================================== -->
        <!-- TELA DE FORMUL√ÅRIO DE NOVA SOLICITA√á√ÉO                                 -->
        <!-- ====================================================================== -->
        <section id="tela-formulario" class="tela w-full max-w-2xl mx-auto flex-col">
             <header class="w-full flex items-center mb-6">
                <button onclick="mostrarTela('tela-principal')" class="text-slate-500 hover:text-emerald-600 mr-4">‚Üê Voltar</button>
                <h1 class="text-2xl font-bold text-slate-700">Nova Solicita√ß√£o</h1>
            </header>
            <main class="w-full bg-white p-6 rounded-lg shadow-md space-y-6">
                <div>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2 mb-4">Tipo de Servi√ßo</h3>
                    <select id="formulario-tipo-servico" class="block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm">
                        <option>Solicita√ß√£o de Poda de √Årvore</option>
                        <option>Solicita√ß√£o de Supress√£o (Corte)</option>
                        <option>Solicita√ß√£o de Fiscaliza√ß√£o de Servi√ßo Realizado</option>
                    </select>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2 mb-4">Endere√ßo do Servi√ßo</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                         <div class="md:col-span-1"><label class="block text-sm font-medium text-slate-600">CEP</label><input type="text" id="formulario-cep" class="mt-1 block w-full px-3 py-2 bg-slate-100 border rounded-md text-sm" readonly></div>
                        <div class="md:col-span-2"><label class="block text-sm font-medium text-slate-600">Logradouro</label><input type="text" id="formulario-logradouro" class="mt-1 block w-full px-3 py-2 bg-slate-100 border rounded-md text-sm" readonly></div>
                        <div><label class="block text-sm font-medium text-slate-600">N√∫mero</label><input type="text" id="formulario-numero" class="mt-1 block w-full px-3 py-2 bg-slate-100 border rounded-md text-sm" readonly></div>
                         <div class="md:col-span-2"><label class="block text-sm font-medium text-slate-600">Bairro</label><input type="text" id="formulario-bairro" class="mt-1 block w-full px-3 py-2 bg-slate-100 border rounded-md text-sm" readonly></div>
                    </div>
                </div>
                 <div>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2 mb-4">Justificativa</h3>
                    <textarea id="formulario-justificativa" rows="4" class="block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm" placeholder="Descreva o motivo da sua solicita√ß√£o..." required></textarea>
                </div>
                 <div>
                    <h3 class="text-lg font-semibold text-slate-700 border-b pb-2 mb-4">Fotos</h3>
                    <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-md">
                        <div class="space-y-1 text-center">
                            <div class="text-4xl text-slate-400">üì∑</div>
                            <div class="flex text-sm text-slate-600">
                                <label for="upload-arquivo" class="relative cursor-pointer bg-white rounded-md font-medium text-emerald-600 hover:text-emerald-500">
                                    <span>Carregar um arquivo</span><input id="upload-arquivo" type="file" class="sr-only" multiple>
                                </label>
                                <p class="pl-1">ou arraste e solte</p>
                            </div><p class="text-xs text-slate-500">PNG, JPG, GIF at√© 10MB</p>
                        </div>
                    </div>
                    <div id="lista-arquivos-upload" class="mt-2 text-sm text-slate-600"></div>
                </div>
                <button onclick="enviarSolicitacao()" class="w-full bg-emerald-600 text-white py-3 px-4 rounded-md hover:bg-emerald-700 font-semibold">Enviar Requerimento</button>
            </main>
        </section>

        <!-- ====================================================================== -->
        <!-- TELA DE LISTA DE SOLICITA√á√ïES                                          -->
        <!-- ====================================================================== -->
        <section id="tela-lista-solicitacoes" class="tela w-full max-w-4xl mx-auto flex-col">
            <header class="w-full flex items-center mb-6">
                <button onclick="mostrarTela('tela-principal')" class="text-slate-500 hover:text-emerald-600 mr-4">‚Üê Voltar</button>
                <h1 class="text-2xl font-bold text-slate-700">Minhas Solicita√ß√µes</h1>
            </header>
            <div id="filtros-container" class="w-full flex justify-center space-x-2 mb-4">
                <button onclick="filtrarSolicitacoes('Todos', this)" class="px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-full hover:bg-slate-100">Todos</button>
                <button onclick="filtrarSolicitacoes('Em An√°lise', this)" class="px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-full hover:bg-slate-100">Em An√°lise</button>
                <button onclick="filtrarSolicitacoes('Aprovado', this)" class="px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-full hover:bg-slate-100">Aprovados</button>
                <button onclick="filtrarSolicitacoes('Recusado', this)" class="px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-full hover:bg-slate-100">Recusados</button>
            </div>
            <main id="container-solicitacoes" class="w-full bg-white p-4 rounded-lg shadow-md space-y-4">
                <!-- Conte√∫do gerado dinamicamente -->
            </main>
        </section>
        
        <!-- ====================================================================== -->
        <!-- TELA DE DETALHES DA SOLICITA√á√ÉO (AGORA COM LINHA DO TEMPO)             -->
        <!-- ====================================================================== -->
        <section id="tela-detalhe-solicitacao" class="tela w-full max-w-2xl mx-auto flex-col">
            <header class="w-full flex items-center mb-6">
                <button onclick="mostrarTela('tela-lista-solicitacoes')" class="text-slate-500 hover:text-emerald-600 mr-4">‚Üê Voltar</button>
                <h1 class="text-2xl font-bold text-slate-700">Detalhe da Solicita√ß√£o</h1>
            </header>
            <main id="container-detalhe-solicitacao" class="w-full bg-white p-6 rounded-lg shadow-md">
                <!-- Conte√∫do da linha do tempo gerado dinamicamente -->
            </main>
        </section>

    </div>

    <!-- Elemento para a notifica√ß√£o (toast) -->
    <div id="notificacao" class="notificacao-toast"></div>

    <script>
        // ====================================================================== //
        // L√ìGICA DO APLICATIVO (JAVASCRIPT) - VERS√ÉO 2                         //
        // ====================================================================== //

        const telas = document.querySelectorAll('.tela');
        const containerSolicitacoes = document.getElementById('container-solicitacoes');
        const containerDetalheSolicitacao = document.getElementById('container-detalhe-solicitacao');
        const inputUploadPrincipal = document.getElementById('upload-arquivo');
        const notificacaoToast = document.getElementById('notificacao');
        
        let usuarioLogado = null; 
        let idReanaliseAtual = null;

        // NOVO: Estrutura de dados com linha do tempo (hist√≥rico)
        const solicitacoesFicticias = [
            { 
                id: '2025-001', type: 'Poda de √Årvore', address: 'Rua das Palmeiras, 123', status: 'Aprovado',
                historico: [
                    { data: '28/09/2025', status: 'Aprovado', descricao: 'Servi√ßo agendado para 05/10/2025 com a equipe credenciada. O prestador de servi√ßo entrar√° em contato.' },
                    { data: '26/09/2025', status: 'Em An√°lise', descricao: 'Vistoria t√©cnica realizada. Aguardando parecer final do departamento.' },
                    { data: '25/09/2025', status: 'Criado', descricao: 'Solicita√ß√£o criada. Justificativa: Galhos muito baixos, atrapalhando a passagem de pedestres na cal√ßada.' },
                ]
            },
            { 
                id: '2025-002', type: 'Supress√£o (Corte)', address: 'Av. Brasil, 789', status: 'Em An√°lise',
                historico: [
                    { data: '28/09/2025', status: 'Em An√°lise', descricao: 'Aguardando vistoria t√©cnica do fiscal ambiental. Prazo de 5 dias √∫teis.' },
                    { data: '28/09/2025', status: 'Criado', descricao: 'Solicita√ß√£o criada. Justificativa: √Årvore apresenta apodrecimento na base e risco iminente de queda sobre a resid√™ncia.' },
                ]
            },
            { 
                id: '2025-003', type: 'Fiscaliza√ß√£o', address: 'Pra√ßa Central, S/N', status: 'Recusado',
                historico: [
                    { data: '20/09/2025', status: 'Recusado', descricao: 'Ap√≥s an√°lise das fotos e vistoria, foi constatado que a poda seguiu as normas t√©cnicas municipais. Solicita√ß√£o indeferida.' },
                    { data: '16/09/2025', status: 'Em An√°lise', descricao: 'Fiscal em rota para vistoria do local.' },
                    { data: '15/09/2025', status: 'Criado', descricao: 'Solicita√ß√£o criada. Justificativa: A poda realizada pelo prestador parece ter sido excessiva e danificou a estrutura da √°rvore.' },
                ]
            },
        ];
        
        function mostrarTela(idDaTela) {
            telas.forEach(tela => tela.classList.remove('tela-ativa'));
            const telaAtiva = document.getElementById(idDaTela);
            if (telaAtiva) telaAtiva.classList.add('tela-ativa');

            if (idDaTela === 'tela-lista-solicitacoes') renderizarListaSolicitacoes();
            if (idDaTela === 'tela-formulario') preencherFormularioComDadosDoUsuario();
            if (idDaTela === 'tela-meus-dados') preencherDadosDoPerfil();
        }

        function mostrarNotificacao(mensagem, tipo = 'sucesso') {
            notificacaoToast.textContent = mensagem;
            notificacaoToast.className = `notificacao-toast ${tipo} mostrar`;
            setTimeout(() => { notificacaoToast.classList.remove('mostrar'); }, 3000);
        }
        
        function efetuarLogin() {
            usuarioLogado = { nome: "Cidad√£o Teste", cpf: "123.456.789-00", cep: "15015-300", logradouro: "Rua XV de Novembro", numero: "3000", bairro: "Centro" };
            document.getElementById('saudacao-usuario').textContent = `Ol√°, ${usuarioLogado.nome}!`;
            mostrarTela('tela-principal');
        }

        // NOVO: Fun√ß√£o para simular login com Gov.br
        function loginGovBr() {
            mostrarNotificacao('Autenticando com Gov.br...', 'info');
            setTimeout(() => {
                usuarioLogado = { nome: "Cidad√£o Gov.br", cpf: "987.654.321-00", cep: "15061-000", logradouro: "Avenida Bady Bassitt", numero: "5000", bairro: "Boa Vista" };
                document.getElementById('saudacao-usuario').textContent = `Ol√°, ${usuarioLogado.nome}!`;
                mostrarTela('tela-principal');
                mostrarNotificacao('Login com Gov.br realizado com sucesso!');
            }, 1500);
        }

        function efetuarLogout() {
            usuarioLogado = null;
            mostrarTela('tela-login');
        }
        
        function cadastrarUsuario() {
            const nome = document.getElementById('cadastro-nome').value;
            const cpf = document.getElementById('cadastro-cpf').value;
            const cep = document.getElementById('cadastro-cep').value;
            const logradouro = document.getElementById('cadastro-logradouro').value;
            const numero = document.getElementById('cadastro-numero').value;
            const bairro = document.getElementById('cadastro-bairro').value;
            const senha = document.getElementById('cadastro-senha').value;
            const confirmacaoSenha = document.getElementById('cadastro-senha-confirmacao').value;

            if (!nome || !cpf || !cep || !logradouro || !numero || !bairro || !senha) return mostrarNotificacao('Por favor, preencha todos os campos.', 'erro');
            if (senha !== confirmacaoSenha) return mostrarNotificacao('As senhas n√£o coincidem.', 'erro');

            usuarioLogado = { nome, cpf, cep, logradouro, numero, bairro };
            mostrarNotificacao(`Conta para ${nome} criada com sucesso!`);
            document.getElementById('saudacao-usuario').textContent = `Ol√°, ${usuarioLogado.nome}!`;
            mostrarTela('tela-principal');
        }

        function recuperarSenha() {
            const cpf = document.getElementById('cpf-recuperacao').value;
            if (!cpf) return mostrarNotificacao('Digite seu CPF ou CNPJ.', 'erro');
            mostrarNotificacao('Se a conta existir, um email de recupera√ß√£o foi enviado.');
            mostrarTela('tela-login');
        }
        
        function buscarCep() {
            const cep = document.getElementById('cadastro-cep').value;
            if (!cep) return mostrarNotificacao('Digite um CEP para buscar.', 'erro');
            
            mostrarNotificacao('Buscando endere√ßo...', 'info');
            setTimeout(() => {
                document.getElementById('cadastro-logradouro').value = 'Rua das Flores (Simulado)';
                document.getElementById('cadastro-bairro').value = 'Jardim dos Testes (Simulado)';
                mostrarNotificacao('Endere√ßo encontrado!', 'sucesso');
            }, 1000);
        }

        function alternarVisibilidadeSenha(idDoInput, idDoIcone) {
            const campoSenha = document.getElementById(idDoInput);
            const icone = document.getElementById(idDoIcone);
            campoSenha.type = (campoSenha.type === 'password') ? 'text' : 'password';
            icone.textContent = (campoSenha.type === 'password') ? 'üëÅÔ∏è' : 'üö´';
        }
        
        function atualizarListaArquivos(inputElement, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            if (inputElement.files.length > 0) {
                let nomesArquivos = '<strong>Arquivos selecionados:</strong><ul class="list-disc pl-5 mt-1">';
                Array.from(inputElement.files).forEach(file => { nomesArquivos += `<li>${file.name}</li>`; });
                container.innerHTML = nomesArquivos + '</ul>';
            }
        }

        function preencherFormularioComDadosDoUsuario() {
            if (usuarioLogado) {
                document.getElementById('formulario-cep').value = usuarioLogado.cep;
                document.getElementById('formulario-logradouro').value = usuarioLogado.logradouro;
                document.getElementById('formulario-numero').value = usuarioLogado.numero;
                document.getElementById('formulario-bairro').value = usuarioLogado.bairro;
            }
        }

        function enviarSolicitacao() {
            const justificativa = document.getElementById('formulario-justificativa').value;
            if (!justificativa) return mostrarNotificacao('Preencha a justificativa.', 'erro');
            
            mostrarNotificacao('Solicita√ß√£o enviada com sucesso!');
            document.getElementById('formulario-justificativa').value = '';
            document.getElementById('upload-arquivo').value = '';
            document.getElementById('lista-arquivos-upload').innerHTML = '';
            mostrarTela('tela-principal');
        }
        
        function solicitarReanalise() {
             const novaJustificativa = document.getElementById('reanalise-justificativa').value;
             if (!novaJustificativa) return mostrarNotificacao('Preencha a nova justificativa.', 'erro');
            
            const solicitacao = solicitacoesFicticias.find(s => s.id === idReanaliseAtual);
            if (solicitacao) {
                solicitacao.status = 'Em An√°lise';
                // NOVO: Adiciona um novo evento ao hist√≥rico
                const hoje = new Date().toLocaleDateString('pt-BR');
                solicitacao.historico.unshift({
                    data: hoje, status: 'Em An√°lise',
                    descricao: `Pedido de rean√°lise recebido. Nova justificativa: ${novaJustificativa}`
                });
            }
            mostrarNotificacao('Pedido de rean√°lise enviado.');
            mostrarTela('tela-lista-solicitacoes');
        }

        function filtrarSolicitacoes(status, botaoClicado) {
            // L√≥gica para destacar o bot√£o ativo
            const botoesFiltro = document.querySelectorAll('#filtros-container button');
            botoesFiltro.forEach(btn => {
                btn.classList.remove('bg-emerald-600', 'text-white');
                btn.classList.add('bg-white', 'text-slate-700');
            });
            botaoClicado.classList.add('bg-emerald-600', 'text-white');
            botaoClicado.classList.remove('bg-white', 'text-slate-700');
            
            renderizarListaSolicitacoes(status);
        }

        function renderizarListaSolicitacoes(filtroStatus = 'Todos') {
            containerSolicitacoes.innerHTML = '';
            const solicitacoesFiltradas = (filtroStatus === 'Todos') ? solicitacoesFicticias : solicitacoesFicticias.filter(s => s.status === filtroStatus);

            if (solicitacoesFiltradas.length === 0) {
                containerSolicitacoes.innerHTML = `<p class="text-center text-slate-500 py-8">Nenhuma solicita√ß√£o encontrada para este filtro.</p>`;
                return;
            }
            solicitacoesFiltradas.forEach(solicitacao => {
                const classeStatus = solicitacao.status.toLowerCase().replace(' ', '-').replace('√°', 'a');
                const elementoSolicitacao = document.createElement('div');
                elementoSolicitacao.className = 'flex flex-col md:flex-row justify-between items-start md:items-center p-4 border rounded-lg hover:bg-slate-50 cursor-pointer';
                elementoSolicitacao.onclick = () => mostrarDetalheSolicitacao(solicitacao.id);
                elementoSolicitacao.innerHTML = `
                    <div class="mb-2 md:mb-0">
                        <p class="font-bold text-slate-700">${solicitacao.type} <span class="text-sm font-normal text-slate-500">#${solicitacao.id}</span></p>
                        <p class="text-sm text-slate-600">${solicitacao.address}</p>
                        <p class="text-xs text-slate-400">√öltima atualiza√ß√£o: ${solicitacao.historico[0].data}</p>
                    </div>
                    <div><span class="etiqueta-status status-${classeStatus}">${solicitacao.status}</span></div>`;
                containerSolicitacoes.appendChild(elementoSolicitacao);
            });
        }
        
        // NOVO: Fun√ß√£o para renderizar a linha do tempo
        function mostrarDetalheSolicitacao(idSolicitacao) {
            const solicitacao = solicitacoesFicticias.find(s => s.id === idSolicitacao);
            if (!solicitacao) return;
            
            idReanaliseAtual = idSolicitacao;
            
            let htmlDetalhes = `
                <div class="mb-6">
                    <h2 class="text-xl font-bold text-slate-800">${solicitacao.type}</h2>
                    <p class="text-sm text-slate-500">Protocolo: #${solicitacao.id}</p>
                    <p class="text-sm text-slate-500">Endere√ßo: ${solicitacao.address}</p>
                </div>
                <div class="timeline">
            `;
            
            solicitacao.historico.forEach(evento => {
                const classeStatus = evento.status.toLowerCase().replace(' ', '-').replace('√°', 'a');
                htmlDetalhes += `
                    <div class="timeline-item">
                        <div class="timeline-dot status-${classeStatus}"></div>
                        <div class="pl-4">
                            <p class="text-sm text-slate-500">${evento.data}</p>
                            <p class="font-bold text-slate-700">${evento.status}</p>
                            <p class="text-slate-600 text-sm">${evento.descricao}</p>
                        </div>
                    </div>
                `;
            });

            htmlDetalhes += `</div>`;

            if (solicitacao.status === 'Recusado') {
                htmlDetalhes += `
                    <div class="border-t mt-6 pt-6 border-dashed border-red-300">
                        <h3 class="text-lg font-bold text-red-700 mb-4">Solicitar Rean√°lise</h3>
                        <div class="space-y-4">
                             <div>
                                <label for="reanalise-justificativa" class="block text-sm font-medium text-slate-600">Nova Justificativa</label>
                                <textarea id="reanalise-justificativa" rows="4" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm" placeholder="Apresente novos argumentos..."></textarea>
                             </div>
                             <div>
                                <label class="block text-sm font-medium text-slate-600">Anexar Novas Fotos</label>
                                <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-md">
                                    <div class="space-y-1 text-center">
                                        <div class="text-4xl text-slate-400">üì∑</div>
                                        <div class="flex text-sm text-slate-600">
                                            <label for="reanalise-upload-arquivo" class="relative cursor-pointer bg-white rounded-md font-medium text-emerald-600 hover:text-emerald-500">
                                                <span>Carregar arquivos</span><input id="reanalise-upload-arquivo" type="file" class="sr-only" multiple>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div id="lista-arquivos-reanalise" class="mt-2 text-sm text-slate-600"></div>
                             </div>
                             <button onclick="solicitarReanalise()" class="w-full bg-orange-500 text-white py-2.5 px-4 rounded-md hover:bg-orange-600 font-semibold">Enviar Pedido de Rean√°lise</button>
                        </div>
                    </div>
                `;
            }

            containerDetalheSolicitacao.innerHTML = htmlDetalhes;
            mostrarTela('tela-detalhe-solicitacao');
            const inputUploadReanalise = document.getElementById('reanalise-upload-arquivo');
            if(inputUploadReanalise) {
                inputUploadReanalise.addEventListener('change', () => atualizarListaArquivos(inputUploadReanalise, 'lista-arquivos-reanalise'));
            }
        }
        
        // --- NOVO: Fun√ß√µes para a tela "Meus Dados" ---
        function preencherDadosDoPerfil() {
            if(usuarioLogado) {
                document.getElementById('perfil-nome').value = usuarioLogado.nome;
                document.getElementById('perfil-cpf').value = usuarioLogado.cpf;
                document.getElementById('perfil-cep').value = usuarioLogado.cep;
                document.getElementById('perfil-logradouro').value = usuarioLogado.logradouro;
                document.getElementById('perfil-numero').value = usuarioLogado.numero;
                document.getElementById('perfil-bairro').value = usuarioLogado.bairro;
            }
        }

        function habilitarEdicaoDados() {
            document.getElementById('fieldset-dados-pessoais').disabled = false;
            // Altera a cor dos inputs para indicar que s√£o edit√°veis
            const inputs = document.querySelectorAll('#fieldset-dados-pessoais input');
            inputs.forEach(input => input.classList.replace('bg-slate-100', 'bg-white'));
            // Troca os bot√µes
            document.getElementById('botao-editar-dados').classList.add('hidden');
            document.getElementById('botao-salvar-dados').classList.remove('hidden');
        }

        function salvarDadosPessoais() {
            // Atualiza o objeto do usu√°rio logado com os novos valores
            usuarioLogado.nome = document.getElementById('perfil-nome').value;
            usuarioLogado.cpf = document.getElementById('perfil-cpf').value;
            usuarioLogado.cep = document.getElementById('perfil-cep').value;
            usuarioLogado.logradouro = document.getElementById('perfil-logradouro').value;
            usuarioLogado.numero = document.getElementById('perfil-numero').value;
            usuarioLogado.bairro = document.getElementById('perfil-bairro').value;
            
            // Desabilita a edi√ß√£o novamente
            document.getElementById('fieldset-dados-pessoais').disabled = true;
            const inputs = document.querySelectorAll('#fieldset-dados-pessoais input');
            inputs.forEach(input => input.classList.replace('bg-white', 'bg-slate-100'));
            // Troca os bot√µes de volta
            document.getElementById('botao-salvar-dados').classList.add('hidden');
            document.getElementById('botao-editar-dados').classList.remove('hidden');
            
            // Atualiza a sauda√ß√£o na tela principal, caso o nome tenha mudado
            document.getElementById('saudacao-usuario').textContent = `Ol√°, ${usuarioLogado.nome}!`;

            mostrarNotificacao('Dados salvos com sucesso!');
        }


        inputUploadPrincipal.addEventListener('change', () => atualizarListaArquivos(inputUploadPrincipal, 'lista-arquivos-upload'));
        document.addEventListener('DOMContentLoaded', () => { mostrarTela('tela-login'); });
    </script>
</body>
</html>

